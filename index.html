<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxehome-calc</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <div class="calc-header">
        <div class="calc-h-left">
            <h1 class="calc-title">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —à—Ç–æ—Ä—ã</h1>
            <p class="calc-opis">–†–∞—Å—á–µ—Ç –∑–∞–π–º–µ—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.</p>
        </div>
        <div class="calc-h-right">
            <div class="cr-opis">
                <h1 class="calc-summa">155.000 –†—É–±–ª–µ–π</h1>
                <p class="calc-srok">–°—Ä–æ–∫ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –¥–æ 10 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π</p>
            </div>
            <div class="knopki">
              <div class="merge-btn-container">
                <a href="" class="text-part">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</a>
                <a href="" class="icon-part">
    <img src="images/Arrow 76.svg" class="icon-part-tw arrow-tw arrow-1tw" alt="">
    <img src="images/Arrow 76inv.svg" class="icon-part-tw arrow-tw arrow-2tw" alt="">
                </a>
              </div>
        </div>
        </div>
    </div>
    <div class="calc-windows">
        
    </div>
    <div class="calc-block">
        <div class="calc-block-left">
            <h2 class="calc-vopros">–ö–∞–∫–∏–µ —à—Ç–æ—Ä—ã –≤–∞–º –Ω—É–∂–Ω—ã?</h2>
            <div class="shtory-tabs">
    <div class="sht-tab" data-target="rim">–†–∏–º—Å–∫–∏–µ —à—Ç–æ—Ä—ã</div>
    <div class="sht-tab is-active" data-target="classic">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —à—Ç–æ—Ä—ã –ø–æ—Ä—Ç—å–µ—Ä—ã</div>
</div>
            <div class="shtory-icon">
                <img src="images/classic-sht.svg" alt="" class="shtory-img">
            </div>
        </div>
        <div class="content-classic-shtory is-active">
        <div class="calc-block-right">
            <div class="calc-fields">
            <div class="calc-field">
  <input
    type="text"
    name="height"
    inputmode="decimal"
    autocomplete="off"
    placeholder=" "
    required
    data-max="3.1"
  >
  <label>–í—ã—Å–æ—Ç–∞ –æ—Ç –ø–æ–ª–∞ –¥–æ –ø–æ—Ç–æ–ª–∫–∞, –º (–ú–∞–∫—Å. 3.1 –º–µ—Ç—Ä–∞)</label>
</div>

<div class="calc-field">
  <input
    type="text"
    name="cornice_length"
    inputmode="decimal"
    autocomplete="off"
    placeholder=" "
    required
  >
  <label>–î–ª–∏–Ω–∞ –∫–∞—Ä–Ω–∏–∑–∞, –º</label>
</div>
        </div>

        <h3 class="koef-sb">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–±–æ—Ä–∫–∏</h3>
        <div class="koef-tabs">
            <div class="koef-btn is-active" data-koef="1.5">
                <img src="images/ks-1.svg" alt="" class="ks-icon">
                <p class="koef-text">1:1.5</p>
            </div>
            <div class="koef-btn" data-koef="2">
                <img src="images/ks-2.svg" alt="" class="ks-icon">
                <p class="koef-text">1:2</p>
            </div>
            <div class="koef-btn" data-koef="2.5">
                <img src="images/ks-3.svg" alt="" class="ks-icon">
                <p class="koef-text">1:2.5</p>
            </div>
        </div>
        <h3 class="tkan-select">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∫–∞–Ω—å</h3>
        <div class="ts-tabs">
            <div class="tkan-tab is-active" data-price="2000">–ë–ª—ç–∫–∞—É—Ç</div>
            <div class="tkan-tab" data-price="2200">–î–∏–º–∞—É—Ç</div>
            <div class="tkan-tab" data-price="2500">–§–∞–∫—Ç—É—Ä–Ω–∞—è —Ç–∫–∞–Ω—å</div>
        </div>
        <div class="cbr-bottom">
            <button class="add-to-calc">–î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–∞—Å—á–µ—Ç</button>
            <div class="calc-price">‚Äî</div>
        </div>

        </div>
        </div>

        
        <div class="content-rim-shtory">
            <div class="calc-block-right">
            <div class="calc-fields">
            <div class="calc-field">
  <input
    type="text"
    name="windowsill_width"
    inputmode="decimal"
    autocomplete="off"
    placeholder=" "
    required
  >
  <label>–®–∏—Ä–∏–Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–∞, —Å–º</label>
</div>

<div class="calc-field">
  <input
    type="text"
    name="window_height"
    inputmode="decimal"
    autocomplete="off"
    placeholder=" "
    required
  >
  <label>–í—ã—Å–æ—Ç–∞ –æ–∫–Ω–∞, —Å–º</label>
</div>
        </div>

        <h3 class="tkan-select">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∫–∞–Ω—å</h3>
        <div class="ts-tabs">
            <div class="tkan-tab is-active" data-price="2000">–ë–ª—ç–∫–∞—É—Ç</div>
            <div class="tkan-tab" data-price="2200">–î–∏–º–∞—É—Ç</div>
            <div class="tkan-tab" data-price="2500">–§–∞–∫—Ç—É—Ä–Ω–∞—è —Ç–∫–∞–Ω—å</div>
        </div>
        <h2 class="rsht-karniz">–ö–∞—Ä–Ω–∏–∑ –≤—Ö–æ–¥–∏—Ç –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å.</h2>
        <h3 class="rsht-dop-zag">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h3>
        <div class="dop-tabs">
            <div class="dop-btn" data-extra="montage">
                <p class="dop-opis">–ú–æ–Ω—Ç–∞–∂</p>
                <p class="dop-price">+3.500‚ÇΩ</p>
            </div>
            <div class="dop-btn" data-extra="delivery">
                <p class="dop-opis">–î–æ—Å—Ç–∞–≤–∫–∞</p>
                <p class="dop-price">+1.000‚ÇΩ</p>
            </div>
        </div>
        <div class="cbr-bottom">
            <button class="add-to-calc">–î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–∞—Å—á–µ—Ç</button>
            <div class="calc-price">‚Äî</div>
        </div>

        </div>
        </div>
    </div>
    






<script>
(function () {
  function sanitizeDecimal(raw) {
    // –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã + . ,
    let v = raw.replace(/[^\d.,]/g, '');

    // –µ—Å–ª–∏ –µ—Å—Ç—å –∏ —Ç–æ—á–∫–∞ –∏ –∑–∞–ø—è—Ç–∞—è ‚Äî —Å—á–∏—Ç–∞–µ–º –∑–∞–ø—è—Ç—É—é –¥–µ—Å—è—Ç–∏—á–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º,
    // –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –≤—ã–∫–∏–¥—ã–≤–∞–µ–º
    const hasDot = v.includes('.');
    const hasComma = v.includes(',');

    if (hasDot && hasComma) {
      // –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∑–∞–ø—è—Ç—É—é –∫–∞–∫ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π, —Ç–æ—á–∫–∏ —É–±–∏—Ä–∞–µ–º
      v = v.replace(/\./g, '');
    }

    // —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ–º –µ–¥–∏–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: –∑–∞–ø—è—Ç–∞—è
    // (—Ç–∞–∫ —É–¥–æ–±–Ω–µ–µ –≤–≤–æ–¥–∏—Ç—å –≤ RU-–ª–æ–∫–∞–ª–∏; –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–∞—Ö –∑–∞–º–µ–Ω–∏–º –Ω–∞ —Ç–æ—á–∫—É)
    // —Ä–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∑–∞–ø—è—Ç—É—é
    const parts = v.split(',');
    if (parts.length > 2) {
      v = parts[0] + ',' + parts.slice(1).join('');
    }

    // –µ—Å–ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∑–∞–ø—è—Ç–æ–π ‚Äî –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ "0,"
    if (v.startsWith(',')) v = '0' + v;

    // —É–±–∏—Ä–∞–µ–º –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏ —Ç–∏–ø–∞ 00012 (–Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º 0,5)
    v = v.replace(/^0+(?=\d)/, '0');

    return v;
  }

  document.addEventListener('input', function (e) {
    const input = e.target;
    if (!input.matches('.calc-field input')) return;

    const before = input.value;
    const after = sanitizeDecimal(before);

    if (before !== after) input.value = after;
  });

  document.addEventListener('blur', function (e) {
    const input = e.target;
    if (!input.matches('.calc-field input')) return;

    let v = sanitizeDecimal(input.value);

    // –µ—Å–ª–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∑–∞–ø—è—Ç—É—é ‚Äî —É–±–∏—Ä–∞–µ–º
    if (v.endsWith(',')) v = v.slice(0, -1);

    // max –¥–ª—è –≤—ã—Å–æ—Ç—ã (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω data-max)
    const maxAttr = input.dataset.max;
    if (maxAttr && v) {
      const num = parseFloat(v.replace(',', '.'));
      const max = parseFloat(maxAttr);
      if (!Number.isNaN(num) && num > max) v = String(max).replace('.', ',');
    }

    input.value = v;
  }, true);
})();
</script>







<script>
const calcState = {
  type: 'classic',   // üëà –ö–õ–Æ–ß–ï–í–û
  classic: {
    length: 0,
    koef: 1.5,
    fabricPrice: 2000
  }
};
</script>

<script>
function resetCalcStateForNewWindow() {
  calcState.type = 'classic';

  calcState.classic = {
    length: 0,
    koef: 1.5,
    fabricPrice: 2000
  };

  calcState.rim = {
    width: 0,
    height: 0,
    fabricPrice: 2000,
    extras: {
      montage: false,
      delivery: false
    }
  };
}
</script>


<script>
function recalcPrice() {
  if (calcState.type !== 'classic') return;

  const { length, koef, fabricPrice } = calcState.classic;
  const priceEl = document.querySelector('.content-classic-shtory .calc-price');

  if (!length) {
    priceEl.textContent = '‚Äî';
    return;
  }

  const price = length * koef * fabricPrice * 2;

  priceEl.textContent =
    Math.round(price).toLocaleString('ru-RU') + ' ‚ÇΩ';
}
</script>

<script>
document.addEventListener('input', e => {
  if (calcState.type !== 'classic') return;

  const input = e.target;
  if (input.name !== 'cornice_length') return;

  // 1Ô∏è‚É£ –æ–±–Ω–æ–≤–ª—è–µ–º calcState
  calcState.classic.length =
    parseFloat(input.value.replace(',', '.')) || 0;

  // 2Ô∏è‚É£ –°–ë–†–ê–°–´–í–ê–ï–ú —É—á–∞—Å—Ç–∏–µ –æ–∫–Ω–∞ –≤ –æ–±—â–µ–π —Å—É–º–º–µ
  const win = windows.find(w => w.id === activeWindowId);
  if (win) {
    win.inTotal = false;
  }

  // 3Ô∏è‚É£ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Å—á—ë—Ç –æ–∫–Ω–∞
  recalcPrice();

  // 4Ô∏è‚É£ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–∫–Ω–æ
  syncActiveWindow();

  // 5Ô∏è‚É£ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â—É—é —Å—É–º–º—É
  calculateTotalPrice();
});
</script>

<script>
document.querySelectorAll('.koef-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    if (calcState.type !== 'classic') return;

    document.querySelectorAll('.koef-btn')
      .forEach(b => b.classList.remove('is-active'));

    btn.classList.add('is-active');
    calcState.classic.koef = parseFloat(btn.dataset.koef);
    recalcPrice();
syncActiveWindow();
calculateTotalPrice();

  });
});
</script>

<script>
document.querySelectorAll('.content-classic-shtory .tkan-tab')
  .forEach(tab => {
    tab.addEventListener('click', () => {
      document
        .querySelectorAll('.content-classic-shtory .tkan-tab')
        .forEach(t => t.classList.remove('is-active'));

      tab.classList.add('is-active');
      calcState.classic.fabricPrice = parseFloat(tab.dataset.price);
      recalcPrice();
syncActiveWindow();
calculateTotalPrice();

    });
  });
</script>



<script>
calcState.rim = {
  width: 0,     // —Å–º
  height: 0,    // —Å–º
  fabricPrice: 2000, 
  extras: {
    montage: false,
    delivery: false
  }
};
</script>

<script>
function recalcRimPrice() {
  if (calcState.type !== 'rim') return;

  const { width, height, fabricPrice, extras } = calcState.rim;
  const priceEl = document.querySelector('.content-rim-shtory .calc-price');

  if (!width || !height) {
    priceEl.textContent = '‚Äî';
    return;
  }

  const w = width / 100;
  const h = (height + 15) / 100;

  let price =
    5000 * w +                  // –±–∞–∑–æ–≤–∞—è —á–∞—Å—Ç—å
    1000 +                      // –∫–∞—Ä–Ω–∏–∑
    fabricPrice * (w + 0.2) +   // —Ç–∫–∞–Ω—å (–ò–°–ü–†–ê–í–õ–ï–ù–û)
    h * w * 2500 +              // –ø–æ—à–∏–≤
    h * w * 500;                // –ª–µ–Ω—Ç–∞

  // –¥–æ–ø—ã
  if (extras.montage) price += 3500;
  if (extras.delivery) price += 1000;

  priceEl.textContent =
    Math.round(price).toLocaleString('ru-RU') + ' ‚ÇΩ';
}

</script>

<script>
document.addEventListener('input', e => {
  if (calcState.type !== 'rim') return;

  const input = e.target;
  if (
    input.name !== 'windowsill_width' &&
    input.name !== 'window_height'
  ) return;

  const win = windows.find(w => w.id === activeWindowId);
  if (win) win.inTotal = false;

  if (input.name === 'windowsill_width') {
    calcState.rim.width =
      parseFloat(input.value.replace(',', '.')) || 0;
  }

  if (input.name === 'window_height') {
    calcState.rim.height =
      parseFloat(input.value.replace(',', '.')) || 0;
  }

  recalcRimPrice();
  syncActiveWindow();
  calculateTotalPrice();
});
</script>

<script>
document
  .querySelectorAll('.content-rim-shtory .tkan-tab')
  .forEach(tab => {
    tab.addEventListener('click', () => {
      document
        .querySelectorAll('.content-rim-shtory .tkan-tab')
        .forEach(t => t.classList.remove('is-active'));

      tab.classList.add('is-active');

      calcState.rim.fabricPrice =
        parseFloat(tab.dataset.price) || 0;

      recalcRimPrice();
syncActiveWindow();
calculateTotalPrice();

    });
  });

</script>

<script>
document
  .querySelectorAll('.content-rim-shtory .dop-btn')
  .forEach(btn => {
    btn.addEventListener('click', () => {
      btn.classList.toggle('is-active');

      const type = btn.dataset.extra;
      calcState.rim.extras[type] = btn.classList.contains('is-active');

      recalcRimPrice();
syncActiveWindow();
calculateTotalPrice();

    });
  });
</script>


<script>
function setCurtainType(type) {
  const win = windows.find(w => w.id === activeWindowId);
  if (!win) return;

  calcState.type = type;

  if (type === 'classic') {
    calcState.classic = { ...win.classic };
  } else {
    calcState.rim = JSON.parse(JSON.stringify(win.rim));
  }

  // —Ç–∞–±—ã
  document.querySelectorAll('.sht-tab')
    .forEach(t => t.classList.remove('is-active'));
  document
    .querySelector(`.sht-tab[data-target="${type}"]`)
    ?.classList.add('is-active');

  // –∫–æ–Ω—Ç–µ–Ω—Ç
  document.querySelector('.content-classic-shtory')
    .classList.toggle('is-active', type === 'classic');
  document.querySelector('.content-rim-shtory')
    .classList.toggle('is-active', type === 'rim');

  // –∫–∞—Ä—Ç–∏–Ω–∫–∞
  document.querySelector('.shtory-img').src =
    type === 'classic'
      ? 'images/classic-sht.svg'
      : 'images/rim-sht.svg';

  // –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—è
  if (type === 'classic') {
    setInput('cornice_length', win.classic.length);
    setInput('height', win.classic.height);
    recalcPrice();
  } else {
    setInput('windowsill_width', win.rim.width);
    setInput('window_height', win.rim.height);
    recalcRimPrice();
  }

  calculateTotalPrice();
}

</script>


<script>
document.querySelectorAll('.sht-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    saveCurrentWindow();
    setCurtainType(tab.dataset.target);
  });
});

</script>




<script>
const MAX_WINDOWS = 9;

let windows = [];
let activeWindowId = null;

function createEmptyWindow(id) {
  return {
    id,
    isTouched: false,
    inTotal: false,
    type: 'classic',

    classic: {
      height: 0,
      length: 0,
      koef: 1.5,
      fabricPrice: 2000
    },

    rim: {
      width: 0,
      height: 0,
      fabricPrice: 2000,
      extras: {
        montage: false,
        delivery: false
      }
    }
  };
}
</script>
<script>
function initWindows() {
  const first = createEmptyWindow(1);
  windows.push(first);
  activeWindowId = 1;

  renderWindows();
  loadWindowState(first);
}

document.addEventListener('DOMContentLoaded', initWindows);
</script>
<script>
function renderWindows() {
  const container = document.querySelector('.calc-windows');
  container.innerHTML = '';

  windows.forEach(win => {
    const el = document.createElement('div');
    el.className = 'c-window-1';
    
    if (win.id === activeWindowId) el.classList.add('is-active');

    el.innerHTML = `
      <p class="cw-zag">–û–∫–Ω–æ ${win.id}</p>
      <button class="remove-btn">
        <img src="images/delete-icon.svg" alt="">
      </button>
    `;

    el.addEventListener('click', () => switchWindow(win.id));

    el.querySelector('.remove-btn').addEventListener('click', e => {
      e.stopPropagation();
      removeWindow(win.id);
    });

    container.appendChild(el);
  });

  // –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
  if (windows.length < MAX_WINDOWS) {
    const add = document.createElement('div');
    add.className = 'c-window-add';
    add.innerHTML = `
      <p class="add-cw">–î–æ–±–∞–≤–∏—Ç—å –æ–∫–Ω–æ</p>
      <button class="add-win">+</button>
    `;
    add.addEventListener('click', addWindow);
    container.appendChild(add);
  }
}
</script>
<script>
function addWindow() {
  if (windows.length >= MAX_WINDOWS) return;

  syncActiveWindow();

  const id = Math.max(...windows.map(w => w.id)) + 1;
  const win = createEmptyWindow(id);

  windows.push(win);
  activeWindowId = id;

  // –ö–õ–Æ–ß–ï–í–û
  calcState.rim = JSON.parse(JSON.stringify(win.rim));
  calcState.classic = { ...win.classic };
  calcState.type = win.type;

  renderWindows();
  loadWindowState(win);

  calculateTotalPrice();
}
</script>
<script>
function removeWindow(id) {
  if (windows.length === 1) return;

  windows = windows.filter(w => w.id !== id);

  if (activeWindowId === id) {
    activeWindowId = windows[0].id;
    loadWindowState(windows[0]);
  }

  renderWindows();

  calculateTotalPrice();

}
</script>
<script>
function switchWindow(id) {
  if (id === activeWindowId) return;

  saveCurrentWindow();
  activeWindowId = id;

  const win = windows.find(w => w.id === id);
  loadWindowState(win);
  renderWindows();
}
</script>
<script>
function saveCurrentWindow() {
  const win = windows.find(w => w.id === activeWindowId);
  if (!win) return;

  win.type = calcState.type;

  if (win.type === 'classic') {
    win.classic = { ...calcState.classic };
    win.classic.height = getInputValue('height');
  } else {
    win.rim = JSON.parse(JSON.stringify(calcState.rim));
  }

  calculateTotalPrice();

}
</script>

<script>
function syncActiveWindow() {
  const win = windows.find(w => w.id === activeWindowId);
  if (!win) return;

  win.isTouched = true;

  win.type = calcState.type;

  if (calcState.type === 'classic') {
    win.classic = {
      ...calcState.classic,
      height: getInputValue('height')
    };
  } else {
    win.rim = JSON.parse(JSON.stringify(calcState.rim));
  }
}
</script>

<script>
function loadWindowState(win) {
  setCurtainType(win.type);

  if (win.type === 'classic') {
    calcState.classic = { ...win.classic };

    setInput('cornice_length', win.classic.length);
    setInput('height', win.classic.height);

    document.querySelectorAll('.koef-btn')
      .forEach(b =>
        b.classList.toggle(
          'is-active',
          parseFloat(b.dataset.koef) === win.classic.koef
        )
      );

    document.querySelectorAll('.content-classic-shtory .tkan-tab')
      .forEach(t =>
        t.classList.toggle(
          'is-active',
          parseFloat(t.dataset.price) === win.classic.fabricPrice
        )
      );

    recalcPrice();
calculateTotalPrice();

  } else {
    calcState.rim = JSON.parse(JSON.stringify(win.rim));

    setInput('windowsill_width', win.rim.width);
    setInput('window_height', win.rim.height);

    document.querySelectorAll('.content-rim-shtory .tkan-tab')
      .forEach(t =>
        t.classList.toggle(
          'is-active',
          parseFloat(t.dataset.price) === win.rim.fabricPrice
        )
      );

    document.querySelectorAll('.dop-btn')
      .forEach(b =>
        b.classList.toggle(
          'is-active',
          win.rim.extras[b.dataset.extra]
        )
      );

    recalcRimPrice();
calculateTotalPrice();

  }

document.querySelectorAll('.add-to-calc').forEach(btn => {
  updateAddToCalcButton(btn, win.inTotal);
});


}

</script>
<script>
function getInputValue(name) {
  const el = document.querySelector(`[name="${name}"]`);
  return el ? parseFloat(el.value.replace(',', '.')) || 0 : 0;
}

function setInput(name, value) {
  const el = document.querySelector(`[name="${name}"]`);
  if (el) el.value = value ? value.toString().replace('.', ',') : '';
}
</script>




<script>
function calculateWindowPrice(win) {
  if (win.type === 'classic') {
    const { length, koef, fabricPrice } = win.classic;
    if (!length) return 0;

    return length * koef * fabricPrice * 2;
  }

  if (win.type === 'rim') {
    const { width, height, fabricPrice, extras } = win.rim;
    if (!width || !height) return 0;

    const w = width / 100;
    const h = (height + 15) / 100;

    let price =
      5000 * w +
      1000 +
      fabricPrice * (w + 0.2) +
      h * w * 2500 +
      h * w * 500;

    if (extras.montage) price += 3500;
    if (extras.delivery) price += 1000;

    return price;
  }

  return 0;
}
</script>
<script>
function calculateTotalPrice() {
  let total = 0;

  windows.forEach(win => {
  if (!win.inTotal) return;
  total += calculateWindowPrice(win);
});


  const el = document.querySelector('.calc-summa');

  el.textContent = total
    ? Math.round(total).toLocaleString('ru-RU') + ' ‚ÇΩ'
    : '‚Äî';
}
</script>



<script>
function updateAddToCalcButton(btn, inTotal) {
  if (inTotal) {
    btn.textContent = '–£–¥–∞–ª–∏—Ç—å –∏–∑ —Ä–∞—Å—á–µ—Ç–∞';
    btn.classList.add('is-remove');
  } else {
    btn.textContent = '–î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–∞—Å—á–µ—Ç';
    btn.classList.remove('is-remove');
  }
}
</script>
<script>
document.querySelectorAll('.add-to-calc').forEach(btn => {
  btn.addEventListener('click', () => {
    const win = windows.find(w => w.id === activeWindowId);
    if (!win) return;

    saveCurrentWindow();

    win.inTotal = !win.inTotal;

    updateAddToCalcButton(btn, win.inTotal);
    calculateTotalPrice();
  });
});

</script>

</body>
</html>